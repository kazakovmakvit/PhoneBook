# Установка Snap в Linux

Одно из самых обсуждаемых нововведений в `Ubuntu 16.04` - это новый формат
установочных пакетов программного обеспечения - snap. Canonical представила
новую систему установки и управления программным обеспечением, она более
безопасна и позволяет получить всегда самые последние версии программ.

Ещё одно преимущество Snap пакетов - это доступность не только в Ubuntu,
но и в других дистрибутивах. Разработчики могут создать один пакет, который
потом можно будет одинаково установить в `Ubuntu`, `Debian`, `Fedora`, `CentOS` или
любом другом дистрибутиве.

Snap пакеты содержат саму программу, а также все её зависимости. Это имеет
несколько преимуществ перед обычными `deb` или `rpm` пакетами, поскольку теперь
программу можно запустить в любом дистрибутиве, а также разработчик может
быть уверен, что его программа получает именно необходимые ей версии
библиотек.

В дистрибутивах, основанных на Debian и в самом Debian для использования
snap пакетов сначала надо установить менеджер пакетов snap. Для этого выполните:
>  `sudo apt install snapd`

После установки для включения возможности установки классических
приложений через snap надо создать символическую ссылку на `/var/lib/snapd/snap` в
корне:
> sudo ln -s /var/lib/snapd/snap /snap

После этого можно установить магазин приложений `snap-store`:
> sudo snap install snap-store

Или устанавливать пакеты snap через терминал.
Чтобы найти нужный пакет или посмотреть есть ли он в магазине приложений
`snap` используйте команду `find`. Например:
> snap find chromium`

Чтобы посмотреть информацию о пакете используйте команду info:
> snap info chromium

Для установки пакетов доступно несколько каналов. Это `stable`, `beta` и `edge`.
Первый самый стабильный, второй - тестируемый, а третий - версия для
разработчиков. Эта информация тоже выводится внизу вывода команды `info`. Здесь
же выводится версия программы в канале.

Вы можете установить snap пакет в Ubuntu или любом другом дистрибутиве
командой `install`:
> sudo snap install chromium

Когда установка snap пакетов завершится, программа выдаст
соответствующее сообщение. Для установки пакета из определенного канала
используйте соответствующую опцию, например
> --stable, --candidate, --beta или --edge.

По умолчанию используется канал stable. Например:
> sudo snap install chromium –edge

По умолчанию приложение может получить доступ только к тем частям
системы, к которым у него подключены интерфейсы. Эти подключения
устанавливаются автоматически во время установки пакета. Посмотреть их можно
командой connections:
> snap connections chromium

Иногда для приложений недостаточно такого уровня доступа. Тогда для них
используется уровень безопасности `classic`. В этом режиме приложение получает
доступ к системным ресурсам как любые другие системные программы. Для
установки таких программ надо использовать опцию `--classic`, иначе установить их
не получится:
> sudo snap install --classic atom

Есть ещё один режим безопасности, при котором приложение получает
полный доступ к системе: `devmode`. Для установки таких программ надо
использовать опцию `--devmode`.
Для обновления всех пакетов, установленных в системе просто выполните
команду `refresh`:
> sudo snap refresh

Если обновление вам не понравилось, вы можете откатить версию всех
пакетов или одного из них до предыдущей. Для этого выполните команду `revert`:
> sudo snap revert opera

#### Удаление Snap в Linux

Пакеты программного обеспечения snap - это очень удобная вещь, поскольку
они позволяют один раз подготовить установочный пакет, который потом можно
развернуть в любом дистрибутиве поддерживающим эту технологию, а таких
дистрибутивов довольно много. Для управления пакетами snap используется
специальный пакетный менеджер.

#### Удаление snap пакета
Для удаления пакета вам надо знать его имя.
Кроме того, можно просто посмотреть все установленные пакеты, обычно их
не очень много, затем уже из них выбрать то, что надо удалить:

> sudo snap list

Для того чтобы его удалить достаточно выполнить такую команду:
> sudo snap remove имя_snap_пакета

По умолчанию пакетный менеджер snap сохраняет две предыдущие версии
пакетов при обновлении. Поскольку один пакет занимает 500-700 мегабайт, это
достаточно много и вы можете захотеть удалить эти пакеты. Можно попросить
пакетный менеджер сохранять только одну резервную копию с помощью такой
команды:
> sudo snap set system refresh.retain=2

В параметры передается цифра 2. Это значит одна актуальная версия, а одна
резервная. Меньше нельзя. Но если очень надо, то можно вручную удалить старые
версии пакетов. Только хочу предупредить, что вы это делаете на свой страх и риск.
Это может сломать систему и таким образом можно удалять только сами
приложения, системные пакеты такие как core, `snapd` и другие трогать ни в коем
случае нельзя. Сначала надо посмотреть список всех пакетов вместе с версиями, это
можно сделать такой командой:
> snap list –all

Для удаления старой версии вручную:
> snap remove имя_snap_пакета --revision=№ ревизии